import{r,Y as x,n as T,o as y,c as v,a as p,a5 as M,bT as z,aA as w,c5 as I,f as C,bP as B,b as k,w as F,e as K,_ as P,bQ as V,bR as A,t as D,u as N,ap as R,at as S,s as b}from"./index.46d84eaa.js";import{A as g,s as j,F as E,f as L}from"./common.7e48d667.js";import{_ as $}from"./_plugin-vue_export-helper.cdc0426e.js";import{i as U}from"./DataTable.d1140bd6.js";import"./Icon.260316a3.js";import"./Tooltip.5bd2a0d9.js";import"./Input.1cc32188.js";import"./use-locale.900634c8.js";import"./Empty.5ff406b4.js";const H={class:"password-page"},O=["onUpdate:modelValue","onInput"],Q=["onKeypress"],Y={__name:"PassInput",props:{num:{type:Number,validator(_){return typeof _=="number"&&_>=4},default:4},id:String,pass:Function,passOk:Function},setup(_){const n=_,a=r([]),l=r(null);x(()=>{T(()=>{u=l.value.children;for(let s of u)s.onchange=({target:t})=>{/^[a-zA-Z0-9]$/.test(t.value)||(t.value="")};u[0].focus()})});const o=function(s){if(n.pass)n.pass(s);else return g.pass(n.id,s).then(t=>{a.value.length=0}).then(t=>{n.passOk()}).catch(t=>{a.value=[]})};let u=[];const d=function(s,t){if(t.inputType==="deleteContentBackward"&&s!=0)u[s-1].focus();else if(t.inputType==="insertText"&&s!=n.num-1)u[s+1].focus();else if(t.inputType==="insertFromPaste")if(s==0){let c=t.target.value;if(c.length>=n.num){for(let e=0;e<4;e++)a.value[e]=c[e];t.target.blur()}else t.target.value=""}else a.value[s]=""},m=function(){if(a.value.join("").length<n.num){window.$message.warning("\u8BF7\u8F93\u5165\u5B8C\u6574\u7684\u5BC6\u7801");return}o(a.value.join(""))};return(s,t)=>{const c=P;return y(),v("div",H,[p("div",{class:"pwd-input",ref_key:"pwdInputs",ref:l,style:B({width:n.num*50+"px"})},[(y(!0),v(M,null,z(new Array(n.num-1),(e,i)=>w((y(),v("input",{class:"y-input","onUpdate:modelValue":f=>a.value[i]=f,onInput:f=>d(i,f)},null,40,O)),[[I,a.value[i]]])),256)),w(p("input",{class:"y-input","onUpdate:modelValue":t[0]||(t[0]=e=>a.value[n.num-1]=e),onInput:t[1]||(t[1]=e=>d(n.num-1,e)),onKeypress:C(m,["enter"])},null,40,Q),[[I,a.value[n.num-1]]])],4),k(c,{style:B({width:n.num*50+"px"}),type:"success",onClick:m},{default:F(()=>[K("\u786E\u8BA4")]),_:1},8,["style"])])}}},Z=$(Y,[["__scopeId","data-v-7d814993"]]);const q={key:0,class:"share-page"},G={style:{width:"960px",margin:"auto"}},J={class:"share-header"},W={class:"resource-list"},X={__name:"Index",setup(_){const n=V(),a=r(n.params.id),l=r(null),o=r([]),u=r(!1);x(()=>{window.$loadingBar.start(),d().then(()=>window.$loadingBar.finish()).catch(()=>window.$loadingBar.error()),setTimeout(()=>{window.$loadingBar.finish()},3e3)});const d=function(e){return j().token===null?(u.value=!0,Promise.resolve(1)):g.getShareList(a.value,e).then(i=>{l.value=i,console.log(l.value)})},m=function(e){const i=o.value;e==-1?o.value=[]:typeof e=="number"?o.value.splice(e+1,o.value.length-e-1):typeof e=="string"&&o.value.push(e),e=o.value.join("/"),d(e).catch(()=>{o.value=i})},s=r([]),t=function(e){s.value=e},c=A([{type:"selection",disabled(e){return e.id==="Edward King 3"}},{title:"\u6587\u4EF6\u540D",key:"name",render:e=>b("a",{class:"fileLink",style:{color:e.type==="dir"?"#E67E22":"#03885B"},onClick:i=>{i.stopPropagation(),e.type==="dir"&&m(e.name)}},[L(e.type),e.name])},{title:"\u4FEE\u6539\u65E5\u671F",key:"updateTime",width:"170",render:e=>e.type=="dir"?"-":new Date(e.updateTime).format("yyyy/MM/dd HH:mm")},{title:"\u7C7B\u578B",key:"type",width:"100",render:e=>e.dir===!0?"-":e.type},{title:"\u5927\u5C0F",key:"size",width:"100",render:e=>e.type==="dir"?"-":e.size>1048576?(e.size/1048576).toFixed(2)+"MB":parseInt(e.size/1024)+"KB"},{title:"\u64CD\u4F5C",key:null,width:"100",render:e=>e.type!=="dir"?b(P,{size:"tiny",type:"info",tertiary:!0,onClick:()=>g.download(e.id,o.value.join("/"))},{default:()=>"\u4E0B\u8F7D"}):null}]);return(e,i)=>{const f=U;return l.value!==null?(y(),v("div",q,[p("div",G,[p("div",J,[p("span",null,"\u8FC7\u671F\u65F6\u95F4\uFF1A"+D(l.value.deadline?new Date(l.value.deadline):"\u6C38\u4E45"),1)]),p("div",W,[k(E,{name:"Share",path:o.value,clickBread:m},null,8,["path"]),k(f,{bordered:!1,"row-key":h=>h.id?h.id:h.name,columns:N(c),data:l.value.resourceList,"onUpdate:checkedRowKeys":t},null,8,["row-key","columns","data"])])])])):u.value?(y(),R(Z,{key:1,id:a.value,"pass-ok":()=>d()},null,8,["id","pass-ok"])):S("",!0)}}},re=$(X,[["__scopeId","data-v-2f957dfc"]]);export{re as default};
