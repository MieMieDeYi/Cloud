import{F as d,e as T,U as D,o as c,c as p,b as y,R as M,c2 as S,a9 as P,c8 as $,c7 as K,bD as x,f as u,W as v,a as I,_ as B,bE as V,bC as j,bz as w,g as E,X as N,bF as R,i as z,c9 as U}from"./index.6d4055d0.js";import{A as f,s as A,f as Y}from"./common.d861a2fb.js";import{_ as C}from"./_plugin-vue_export-helper.cdc0426e.js";import{F as H}from"./FilePath.0e5ecdb1.js";import{P as O}from"./FilePreview.d12991f6.js";import{_ as W}from"./Empty.38beec9d.js";import{p as X}from"./DataTable.465f5622.js";import"./Explore.5bdeed77.js";import"./YIcon.481673e0.js";import"./Icon.531e1a0b.js";import"./use-merged-state.0840fd6e.js";import"./Image.680ab1b7.js";import"./Tooltip.7caa8588.js";import"./get.aaddbb89.js";import"./use-locale.45f23c9d.js";import"./temp.f71b06cc.js";import"./Input.bba7bf28.js";import"./ChevronRight.fd0d3a5a.js";const Z={class:"password-page"},q=["onUpdate:modelValue","onInput"],G=["onKeypress"],J={__name:"PassInput",props:{num:{type:Number,validator(h){return typeof h=="number"&&h>=4},default:4},id:String,pass:Function,passOk:Function},setup(h){const s=h,n=d([]),a=d(null);T(()=>{D(()=>{r=a.value.children;for(let o of r)o.onchange=({target:t})=>{/^[a-zA-Z0-9]$/.test(t.value)||(t.value="")};r[0].focus()})});const l=function(o){if(s.pass)s.pass(o);else return f.pass(s.id,o).then(t=>{n.value.length=0}).then(t=>{s.passOk()}).catch(t=>{n.value=[]})};let r=[];const _=function(o,t){if(t.inputType==="deleteContentBackward"&&o!=0)r[o-1].focus();else if(t.inputType==="insertText"&&o!=s.num-1)r[o+1].focus();else if(t.inputType==="insertFromPaste")if(o==0){let m=t.target.value;if(m.length>=s.num){for(let e=0;e<4;e++)n.value[e]=m[e];t.target.blur()}else t.target.value=""}else n.value[o]=""},k=function(){if(n.value.join("").length<s.num){window.$message.warning("\u8BF7\u8F93\u5165\u5B8C\u6574\u7684\u5BC6\u7801");return}l(n.value.join(""))};return(o,t)=>{const m=B;return c(),p("div",Z,[y("div",{ref_key:"pwdInputs",ref:a,class:"pwd-input",style:x({width:s.num*50+"px"})},[(c(!0),p(M,null,S(new Array(s.num-1),(e,i)=>P((c(),p("input",{key:i,"onUpdate:modelValue":g=>n.value[i]=g,class:"y-input",onInput:g=>_(i,g)},null,40,q)),[[$,n.value[i]]])),128)),P(y("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.value[s.num-1]=e),class:"y-input",onInput:t[1]||(t[1]=e=>_(s.num-1,e)),onKeypress:K(k,["enter"])},null,40,G),[[$,n.value[s.num-1]]])],4),u(m,{style:x({width:s.num*50+"px"}),type:"success",onClick:k},{default:v(()=>[I(" \u786E\u8BA4 ")]),_:1},8,["style"])])}}},Q=C(J,[["__scopeId","data-v-7e388e65"]]);const ee={key:0,class:"share-page"},te={style:{width:"960px",margin:"auto"}},se={class:"share-header"},ne={key:0},ae={key:1},oe={key:2,class:"resource-list"},ie={class:"resource-list"},le={__name:"Share",setup(h){const s=R(),n=d(s.params.id),a=d(null),l=d([]),r=d(!1);T(()=>{window.$loadingBar.start(),f.pass(n.value,null).then(()=>{_()}).catch(()=>{r.value=!0}),setTimeout(()=>{window.$loadingBar.finish()},1e4)});const _=function(e){return A().token===null?(r.value=!0,Promise.resolve(1)):(window.$loadingBar.start(),f.getShareList(n.value,e).then(i=>{a.value=i,console.log(a.value),window.$loadingBar.finish()}))},k=function(e){const i=l.value;e===0?l.value=[]:typeof e=="number"?l.value.splice(e,l.value.length-e):typeof e=="string"&&l.value.push(e),e=l.value.join("/"),_(e).catch(()=>{l.value=i})},o=d([]),t=function(e){o.value=e},m=V([{type:"selection",disabled(e){return e.id==="Edward King 3"}},{title:"\u6587\u4EF6\u540D",key:"name",render:e=>z("a",{class:"fileLink",style:{color:e.type==="dir"?"#E67E22":"#03885B"},onClick:i=>{i.stopPropagation(),e.type==="dir"&&k(e.name)}},[Y(e.type),e.name])},{title:"\u4FEE\u6539\u65E5\u671F",key:"updateTime",width:"170",render:e=>e.type==="dir"?"-":new Date(e.updateTime).format("YYYY/MM/DD HH:mm")},{title:"\u7C7B\u578B",key:"type",width:"100",render:e=>e.dir===!0?"-":e.type},{title:"\u5927\u5C0F",key:"size",width:"100",render:e=>e.type==="dir"?"-":e.size>1048576?(e.size/1048576).toFixed(2)+"MB":parseInt(e.size/1024)+"KB"},{title:"\u64CD\u4F5C",key:null,width:"100",render:e=>e.type!=="dir"?z(B,{size:"tiny",type:"info",tertiary:!0,onClick:()=>f.download(e.id,l.value.join("/"))},{default:()=>"\u4E0B\u8F7D"}):null}]);return(e,i)=>{const g=W,F=U,L=X;return a.value!==null?(c(),p("div",ee,[y("div",te,[y("div",se,[y("span",null,"\u8FC7\u671F\u65F6\u95F4\uFF1A"+j(a.value.deadline?new Date(a.value.deadline):"\u6C38\u4E45"),1)]),a.value.resourceList.length===0?(c(),p("div",ne,[u(g,{description:"\u4F60\u4EC0\u4E48\u4E5F\u627E\u4E0D\u5230"},{extra:v(()=>[u(w(B),{size:"small"},{default:v(()=>[I(" \u770B\u770B\u522B\u7684 ")]),_:1})]),_:1})])):a.value.resourceList.length===1?(c(),p("div",ae,[u(F,{title:a.value.resourceList[0].name},{"header-extra":v(()=>[u(w(B),{type:"primary",dashed:"",size:"small",onClick:i[0]||(i[0]=b=>w(f).download(a.value.resourceList[0].id,l.value.join("/")))},{default:v(()=>[I(" \u4E0B\u8F7D ")]),_:1})]),default:v(()=>[u(O,{api:w(f).preview,resource:a.value.resourceList[0]},null,8,["api","resource"])]),_:1},8,["title"])])):(c(),p("div",oe,[y("div",ie,[u(H,{name:"Share",path:l.value,"click-bread":k},null,8,["path"]),u(L,{bordered:!1,"row-key":b=>b.id?b.id:b.name,columns:w(m),data:a.value.resourceList,"onUpdate:checkedRowKeys":t},null,8,["row-key","columns","data"])])]))])])):r.value?(c(),E(Q,{key:1,id:n.value,"pass-ok":()=>_()},null,8,["id","pass-ok"])):N("",!0)}}},$e=C(le,[["__scopeId","data-v-1bb293c9"]]);export{$e as default};
